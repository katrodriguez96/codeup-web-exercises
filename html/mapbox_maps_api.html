<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mapbox Maps API</title>
    <!-- Mapbox CSS -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <!-- Custom CSS -->
    <style>
        #map {
            /* the width and height may be set to any size */
            width: 90%;
            height: 700px;
            margin: auto;
        }

    </style>
</head>
<body>
<button type="button" id="hide">Hide markers</button>
<form>
    <label for="address">Enter address:</label>
    <input type="text" id="address" name="address">
    <input type="button" id="submit" value="Submit">
</form>
<div id="map"></div>

<!-- jQuery -->
<script src="../js/jquery-2.2.4.js"></script>
<!-- Mapbox JS -->
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<!-- API -->
<script src="../js/keys.js"></script>
<!-- Mapbox Geocoder Util Methods -->
<script src="../js/mapbox-geocoder-utils.js"></script>
<!-- Custom JS -->
<script>
    // hide markers button
    $('#hide').click(function () {
        $('svg').toggle();
    })
    // creates map centered on San Antonio
    mapboxgl.accessToken = MAPBOX_EXERCISE;
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        zoom: 10,
        center: [-98.4916, 29.4252]
    });
    // mark and center on user input
    $('#submit').click(function () {
        var address = $('#address').val()
        console.log(address)
        geocode(address, MAPBOX_EXERCISE).then(function (result) {
            var marker = new mapboxgl.Marker()
                .setLngLat(result)
                .addTo(map)
                map.setCenter(result)
                map.setZoom(15)
        })
    })
    // restaurant info
    var restaurants = [{
        name: 'Kimura',
        address: '1017 N Flores St, San Antonio, TX 78212',
        type: 'Japanese restaurant',
        price: '$$',
        info: 'Compact eatery with simple decor serving Japanese fare including ramen.'
    }, {
        name: 'Chama Gaúcha',
        address: '18318 Sonterra Pl, San Antonio, TX 78258',
        type: 'Brazilian steakhouse',
        price: '$$$',
        info: 'Upscale all-you-can-eat churrascaria with grilled beef, pork, chicken & lamb, plus a vast salad bar.'
    }, {
        name: 'Barrio Barista',
        address: '3735 Culebra Rd, San Antonio, TX 78228',
        type: 'Coffee shop',
        price: '$',
        info: 'Rustic-chic cafe offering creative coffee drinks & breakfast/lunch fare, including tacos & burgers.'
    }];
    // loops through array and creates marker with popup
    restaurants.forEach(function (element, index) {
        geocode(element.address, MAPBOX_EXERCISE).then(function (result) {
            var marker = new mapboxgl.Marker()
                .setLngLat(result)
                .addTo(map);
            var popup = new mapboxgl.Popup()
                .setHTML("<h3>" + element.name + "</h3><p>" + element.price + " · " + element.type + "</p><p>" + element.info + "</p>")
            marker.setPopup(popup)
        })
    });
    // the geocode method finding and centering on Kimura
    // geocode(restaurants[0].address, MAPBOX_EXERCISE).then(function(result) {
    //     console.log(result); // logs coordinates
    //     var kimuraMarker = new mapboxgl.Marker()
    //         .setLngLat(result)
    //         .addTo(map);
    //     var kimuraPopup = new mapboxgl.Popup()
    //         .setHTML("<h3>Kimura</h3>")
    //     kimuraMarker.setPopup(kimuraPopup)
    // });
    //
    // geocode("18318 Sonterra Pl, San Antonio, TX 78258", MAPBOX_EXERCISE).then(function(result) {
    //     console.log(result);
    // });
    // var steakMarker = new mapboxgl.Marker()
    //     .setLngLat([-98.49774, 29.61026])
    //     .addTo(map);
    // var steakPopup = new mapboxgl.Popup()
    //     .setHTML("<h3>Chama Gaúcha</h3>")
    // steakMarker.setPopup(steakPopup)
    //
    // geocode("3735 Culebra Rd, San Antonio, TX 78228", MAPBOX_EXERCISE).then(function(result) {
    //     console.log(result);
    // });
    // var coffeeMarker = new mapboxgl.Marker()
    //     .setLngLat([-98.577652, 29.45049])
    //     .addTo(map);
    // var coffeePopup = new mapboxgl.Popup()
    //     .setHTML("<h3>Barrio Barista</h3>")
    // coffeeMarker.setPopup(coffeePopup)
</script>
</body>
</html>